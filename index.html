<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Home</title>
</head>
<body>
    <div class="boxed">
        <h1>Lorem ipsum dolor sit amet consectetur adipisicing elit.</h1>
        <img class="cover" src="../img/lucid-dream.jpg" alt="Home picture">
        <p id="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Soluta doloremque voluptates optio, numquam enim ut
            minus nesciunt dolore odit officia quam quas quod error corrupti eligendi neque quibusdam nostrum cupiditate.
        </p>
        <div id="classes_selector">
            <div class="classe_selector" id="classe_selector1" onclick="classe1()">
                <p>Lorem ipsum dolor sit.</p>
            </div>
            <div class="classe_selector" id="classe_selector2" onclick="classe2()">
                <p>Lorem ipsum dolor sit amet.</p>
            </div>
            <div class="classe_selector" id="classe_selector3" onclick="classe3()">
                <p>Lorem ipsum dolor sit, amet consectetur adipisicing.</p>
            </div>
            <div class="classe_selector" id="classe_selector4" onclick="classe4()">
                <p>Lorem ipsum dolor sit amet.</p>
            </div>
        </div>
        <span class="separate"></span>
        <div id="classes_container">
            <div id="classe1">
                <h2>Lorem ipsum dolor sit.</h2>
                <div class="articles">
                    <a href="articles.html?article=1">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=2">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=3">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                </div>
            </div>
            <div id="classe2">
                <h2>Lorem ipsum dolor sit amet.</h2>
                <div class="articles">
                    <a href="articles.html?article=4">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=5">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=6">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                </div>
            </div>
            <div id="classe3">
                <h2>Lorem ipsum dolor sit, amet consectetur adipisicing.</h2>
                <div class="articles">
                    <a href="articles.html?article=7">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=8">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=9">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                </div>
            </div>
            <div id="classe4">
                <h2>Lorem ipsum dolor sit amet.</h2>
                <div class="articles">
                    <a href="articles.html?article=10">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=11">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                    <a href="articles.html?article=12">
                        <h3>Lorem ipsum dolor sit amet.</h3>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <script>
        const sel1 = document.getElementById("classe_selector1");
        const sel2 = document.getElementById("classe_selector2");
        const sel3 = document.getElementById("classe_selector3");
        const sel4 = document.getElementById("classe_selector4");

        const c1 = document.getElementById("classe1");
        const c2 = document.getElementById("classe2");
        const c3 = document.getElementById("classe3");
        const c4 = document.getElementById("classe4");

        function classe1() {
            sel1.style.borderBottom = "3px solid #114c81";
            sel2.style.borderBottom = "none";
            sel3.style.borderBottom = "none";
            sel4.style.borderBottom = "none";

            c1.style.display = "block";
            c2.style.display = "none";
            c3.style.display = "none";
            c4.style.display = "none";
            return;
        }
        function classe2() {
            sel1.style.borderBottom = "none";
            sel2.style.borderBottom = "2px solid #114c81";
            sel3.style.borderBottom = "none";
            sel4.style.borderBottom = "none";

            c1.style.display = "none";
            c2.style.display = "block";
            c3.style.display = "none";
            c4.style.display = "none";
            return;
        }
        function classe3() {
            sel1.style.borderBottom = "none";
            sel2.style.borderBottom = "none";
            sel3.style.borderBottom = "2px solid #114c81";
            sel4.style.borderBottom = "none";

            c1.style.display = "none";
            c2.style.display = "none";
            c3.style.display = "block";
            c4.style.display = "none";
            return;
        }

        function classe4() {
            sel1.style.borderBottom = "none";
            sel2.style.borderBottom = "none";
            sel3.style.borderBottom = "none";
            sel4.style.borderBottom = "2px solid #114c81";

            c1.style.display = "none";
            c2.style.display = "none";
            c3.style.display = "none";
            c4.style.display = "block";
            return;
        }

        function run_articles() {

            async function chargerTitresArticles() {
                const blocsArticles = document.querySelectorAll(".articles");

                blocsArticles.forEach(bloc => {
                    const liens = bloc.querySelectorAll("a");

                    liens.forEach(async a => {
                        const href = a.getAttribute("href");
                        if (!href || !href.includes("article=")) return;

                        const articleID = href.split("article=")[1];
                        const url = "articles/" + articleID + ".html";

                        try {
                            const response = await fetch(url);
                            const html = await response.text();

                            const parser = new DOMParser();
                            const doc = parser.parseFromString(html, "text/html");
                            if (!doc) throw new Error("Document non chargé");
                            const titre = doc.title;
                            if (!titre) throw new Error("Titre non trouvé");

                            const h3 = a.querySelector("h3");
                            if (h3) {
                                h3.innerText = titre;
                            }
                        } catch (e) {
                            console.error("Erreur chargement article", url);
                        }
                    });
                });
            }

            // lancer le chargement asynchrone des titres
            chargerTitresArticles();
        }

        classe1();
        run_articles();

        /*
            const urlParams = new URLSearchParams(window.location.search);
            const article = urlParams.get('article');

            if(article >= 1 && article <= 3){
                classe1();
            } else if(article >= 4 && article <= 6){
                classe2();
            } else if(article >= 7 && article <= 9){
                classe3();
            } else if(article >= 10 && article <= 12){
                classe4();
            }
        */
    </script>
</body>
</html>